# Malware Protection Policy
Source: https://help.zscaler.com/zia/malware-protection-policy

API Reference Guide for the ZIA Cloud Service and Sandbox Submission APIs

**Base URL:** https://zsapi.[zscaler-cloud-name]/api/v1

## `GET /cyberThreatProtection/atpMalwareInspection`

Retrieves the traffic inspection configurations of Malware Protection policy

**Tags:** Malware Protection Policy
**Consumes:** application/json
**Produces:** application/json
No parameters.

| Code | Description | Schema |
| ---- | ----------- | ------ |
| 200 | Successful Operation | AtpMalwareInspection |

## `PUT /cyberThreatProtection/atpMalwareInspection`

Updates the traffic inspection configurations of Malware Protection policy. To learn more, see [Configuring the Malware Protection Policy](/zia/configuring-malware-protection-policy).

**Tags:** Malware Protection Policy
**Consumes:** application/json
**Produces:** application/json

| Name | In | Type | Required | Description |
| ---- | --- | ---- | -------- | ----------- |
| body | body | AtpMalwareInspection | No | Malware Protection policy configuration |

| Code | Description | Schema |
| ---- | ----------- | ------ |
| 200 | Successful Operation | AtpMalwareInspection |

## `GET /cyberThreatProtection/atpMalwareProtocols`

Retrieves the protocol inspection configurations of Malware Protection policy

**Tags:** Malware Protection Policy
**Consumes:** application/json
**Produces:** application/json
No parameters.

| Code | Description | Schema |
| ---- | ----------- | ------ |
| 200 | Successful Operation | AtpMalwareProtocols |

## `PUT /cyberThreatProtection/atpMalwareProtocols`

Updates the protocol inspection configurations of Malware Protection policy. To learn more, see [Configuring the Malware Protection Policy](/zia/configuring-malware-protection-policy).

**Tags:** Malware Protection Policy
**Consumes:** application/json
**Produces:** application/json

| Name | In | Type | Required | Description |
| ---- | --- | ---- | -------- | ----------- |
| body | body | AtpMalwareProtocols | No | Malware Protection policy configuration |

| Code | Description | Schema |
| ---- | ----------- | ------ |
| 200 | Successful Operation | AtpMalwareProtocols |

## `GET /cyberThreatProtection/malwarePolicy`

Retrieves information about the security exceptions configured for the Malware Protection policy

**Tags:** Malware Protection Policy
**Consumes:** application/json
**Produces:** application/json
No parameters.

| Code | Description | Schema |
| ---- | ----------- | ------ |
| 200 | Successful Operation | MalwarePolicyConfig |

## `PUT /cyberThreatProtection/malwarePolicy`

Updates security exceptions for the Malware Protection policy.  To learn more, see [Configuring the Malware Protection Policy](/zia/configuring-malware-protection-policy).

**Tags:** Malware Protection Policy
**Consumes:** application/json
**Produces:** application/json
No parameters.

| Code | Description | Schema |
| ---- | ----------- | ------ |
| 200 | Successful Operation | MalwarePolicyConfig |

## `GET /cyberThreatProtection/malwareSettings`

Retrieves the malware protection policy configuration details

**Tags:** Malware Protection Policy
**Consumes:** application/json
**Produces:** application/json
No parameters.

| Code | Description | Schema |
| ---- | ----------- | ------ |
| 200 | Successful Operation | MalwareSettings |

## `PUT /cyberThreatProtection/malwareSettings`

Updates the malware protection policy configuration details. To learn more, see [Configuring the Malware Protection Policy](/zia/configuring-malware-protection-policy).

**Tags:** Malware Protection Policy
**Consumes:** application/json
**Produces:** application/json

| Name | In | Type | Required | Description |
| ---- | --- | ---- | -------- | ----------- |
| body | body | MalwareSettings | No |  |

| Code | Description | Schema |
| ---- | ----------- | ------ |
| 200 | Successful Operation | MalwareSettings |

## Models
### AtpMalwareInspection
Traffic inspection configurations for Malware Protection policy
| Field | Type | Required | Description |
| ----- | ---- | -------- | ----------- |
| inspectInbound | boolean | No | A Boolean value that enables or disables scanning of incoming internet traffic for malicious content |
| inspectOutbound | boolean | No | A Boolean value that enables or disables scanning of outgoing internet traffic for malicious content |

### AtpMalwareProtocols
Protocol inspection configurations for Malware Protection policy
| Field | Type | Required | Description |
| ----- | ---- | -------- | ----------- |
| inspectFtp | boolean | No | A Boolean value that enables or disables scanning of FTP traffic for malicious content in real time |
| inspectFtpOverHttp | boolean | No | A Boolean value that enables or disables scanning of FTP over HTTP traffic for malicious content in real time |
| inspectHttp | boolean | No | A Boolean value that enables or disables scanning of HTTP traffic (and HTTPS traffic if [SSL Inspection](/zia/deploying-ssl-inspection) is enabled) for malicious content in real time |

### MalwarePolicyConfig
Malware Protection policy security exceptions
| Field | Type | Required | Description |
| ----- | ---- | -------- | ----------- |
| blockPasswordProtectedArchiveFiles | boolean | No | A Boolean value indicating whether to allow or block users from uploading or downloading password-protected files |
| blockUnscannableFiles | boolean | No | A Boolean value indicating whether to allow or block users from uploading or downloading files that the Zscaler service is unable to scan. This might occur if the file is an unrecognized file format, an excessive size, or recursively compressed. |

### MalwareSettings
Malware Protection policy settings
| Field | Type | Required | Description |
| ----- | ---- | -------- | ----------- |
| adwareBlocked | boolean | No | A Boolean value indicating whether malicious files that automatically render advertisements and install adware are allowed or blocked |
| adwareCapture | boolean | No | A Boolean value specifying whether packet capture (PCAP) is enabled or disabled for adware |
| ransomwareBlocked | boolean | No | A Boolean value specifying whether to allow or block malicious programs that can encrypt files and prevent users from accessing their devices, files, or data until a ransom payment is made. |
| ransomwareCapture | boolean | No | A Boolean value specifying whether packet capture (PCAP) is enabled or disabled for ransomware |
| remoteAccessToolBlocked | boolean | No | A Boolean value specifying whether to allow or block file download from tools that are common from remote access sites |
| remoteAccessToolCapture | boolean | No | A Boolean value specifying whether packet capture (PCAP) is enabled or disabled for remote access tools |
| spywareBlocked | boolean | No | A Boolean value indicating whether malicious files that covertly gather information about a user or an organization are allowed or blocked |
| spywareCapture | boolean | No | A Boolean value specifying whether packet capture (PCAP) is enabled or disabled for spyware |
| trojanBlocked | boolean | No | A Boolean value that allows or blocks malicious programs such as Trojan viruses that are presented as beneficial or useful |
| trojanCapture | boolean | No | A Boolean value specifying whether packet capture (PCAP) is enabled or disabled for Trojan viruses |
| unwantedApplicationsBlocked | boolean | No | A Boolean value that allows or blocks unwanted files that are downloaded alongside intentional programs downloaded by users |
| unwantedApplicationsCapture | boolean | No | A Boolean value specifying whether packet capture (PCAP) is enabled or disabled for unwanted applications |
| virusBlocked | boolean | No | A Boolean value that indicates if malicious programs that cause damage to systems and data are allowed or blocked. This setting applies to any viruses that don't fit into the more specific malware categories. |
| virusCapture | boolean | No | A Boolean value specifying whether packet capture (PCAP) is enabled or disabled for viruses |
| wormBlocked | boolean | No | A Boolean value indicating whether malicious programs that duplicate themselves to spread malicious code to other devices are allowed or blocked |
| wormCapture | boolean | No | A Boolean value specifying whether packet capture (PCAP) is enabled or disabled for worms |
