# Adding a Vulnerability Scanning Rule for Containers
Source: https://help.zscaler.com/zpc/adding-vulnerability-scanning-rule-containers
PDF: https://help.zscaler.com/pdf/com/en/1447556.pdf

You can add a vulnerability scanning rule to scan the container images that are deployed to Amazon Elastic Kubernetes Service (Amazon EKS), Google Kubernetes Engine (GKE) or Azure Kubernetes Service (AKS) clusters. ZPC scans the container images based on the scan schedule and displays the results on the Vulnerability Management page. To learn more, see [About Vulnerability Management](/zpc/about-vulnerability-management). You can also get detailed insights of the findings on the [vulnerability dashboard](/zpc/viewing-vulnerability-dashboard).
Prerequisites
You must first onboard and add vulnerability scanning permissions for AWS or Google accounts that host container images in Amazon EKS, GKE, or AKS clusters, respectively. To learn more, see [Onboarding an Amazon Kubernetes Service Cluster](/zpc/onboarding-amazon-elastic-kubernetes-service-cluster), [Onboarding a Google Platform Account](/zpc/onboarding-google-cloud-platform-account), and [Onboarding an Azure Kubernetes Service Cluster](/zpc/onboarding-azure-kubernetes-service-cluster). After onboarding the AWS, Google, or AKS accounts, you must integrate ZPC with the required clusters before adding a scanning rule.
ZPC provides support only for scanning images present in elastic container registries (ECR), Google Container Registry (GCR), Google Artifact Registry (GAR), and Azure Container Registry (ACR).
Adding a Vulnerability Scanning Rule for Containers
To add a scanning rule for container images:
- Go to **Cloud Posture **>** Vulnerability Management**.
- On the **Vulnerability Management** page, click the **Scanning Rules** tab.
- Click **Create Scan Rule**.
[See image.](#addrule)
- Under **General Information**:
- **Scan Rule Name**: Enter a unique name for the scan rule.
- **Vulnerability Scanning Type**: **Select Workloads &** **Containers**.
- **Choose the Cloud Type**: Select **Google Cloud** or **Kubernetes**.
[See image.](#select-cloudtype)
- Click **Next**.
- Under **Resource Scope**: , define the selection criteria for scanning the containers:
- **Cluster Type**: Select the required cluster type (EKS, GKE, or AKS) from the drop-down menu.
- **Cloud Accounts**: Select the cloud account from the drop-down menu. The cloud account is displayed based on the cluster type you selected.
- **Cloud Regions**: Select the region from the drop-down menu.
- **Clusters **: Select the cluster from the drop-down menu.
[See image.](#resourcescope)
- Click **Next**.
The **Scope Test Result** window displays the number of containers that are included for vulnerability scanning.
[See image.](#scope)
- Click **Accept and Proceed**.
- Under **Scan Schedule**, select the time when the scan must be performed daily.
[See image.](#scan-schedule)
- Click **Next**.
- Review the scan rule. Click the **Edit** icon if you want to make any changes.
[See image.](#reviewrule)
- Click **Finish**.
You can view the newly added scan rule on the **Vulnerability Management** page under **Scanning Rules**.
[![Add a vulnerability scan rule](/downloads/zpc/container-registries-workloads/vulnerability-scanning/adding-vulnerability-scanning-rule-container-images/zpc-vm-page.png)
]
[![Select the required cloud type](/downloads/zpc/container-registries-workloads/vulnerability-scanning/adding-vulnerability-scanning-rule-containers/zpc-vm-workload-containers.png?1680690273)
]
[![Configure the resource scope](/downloads/zpc/container-registries-workloads/vulnerability-scanning/adding-vulnerability-scanning-rule-containers/zpc-scanrule-eksresourcescope.png)
]
[![View the scope results](/downloads/zpc/container-registries-workloads/vulnerability-scanning/adding-vulnerability-scanning-rule-container-images/zpc-vs-scoperesult.png)
]
[![Set up the scan schedule](/downloads/zpc/container-registries-workloads/vulnerability-scanning/adding-vulnerability-scanning-rule-container-images/zpc-vs-scanschedule.png)
]
[![Review the scan rule](/downloads/zpc/container-registries-workloads/vulnerability-scanning/adding-vulnerability-scanning-rule-container-images/zpc-vs-reviewrule.png)
]