# Adding a Vulnerability Scanning Rule for Cloud Workloads
Source: https://help.zscaler.com/zpc/adding-vulnerability-scanning-rule-cloud-workloads
PDF: https://help.zscaler.com/pdf/com/en/1411281.pdf

You can add a vulnerability scanning rule and set up a schedule for the scan to run at regular intervals. You can add a scanning rule for Amazon Web Services (AWS), Azure, or Google Cloud Platform (GCP) cloud workloads. ZPC scans the cloud workloads and the scan results are displayed on the Vulnerability Management page. To learn more, see [About Vulnerability Management](/zpc/about-vulnerability-management). You can also get detailed insights of the findings on the [vulnerability dashboard](/zpc/viewing-vulnerability-dashboard).
Prerequisites
You must first onboard your Amazon Web Services (AWS), Azure, or GCP accounts. To learn more, see [Onboarding an Amazon Web Services Account](/zpc/onboarding-amazon-web-services-account), [Onboarding a Microsoft Azure Account](/zpc/onboarding-microsoft-azure-account), and [Onboarding a Google Cloud Platform Account](/zpc/onboarding-google-cloud-platform-account). After onboarding the accounts, you must integrate ZPC with the required cloud accounts before adding a scanning rule. To learn more, see [About Vulnerability Integrations](/zpc/about-vulnerability-integrations).
ZPC creates snapshots of your cloud workloads to detect vulnerabilities. After the vulnerability scan is completed, ZPC deletes the snapshots to avoid additional costs. The snapshots are created with the following tag keys:
- scanType
- tenantId
- Id
- scanId
The tag keys are used to identify and delete all the snapshots created by ZPC. So, ensure that you don't delete these tag keys from the snapshots due to any organization-level policies. If you delete the tag keys, ZPC cannot delete or clean up the snapshots.
Adding a Vulnerability Scanning Rule for Cloud Workloads
To add a scanning rule:
- Go to **Cloud Posture **>** Vulnerability Management**.
- On the **Vulnerability Management** page, click the **Scanning Rules** tab.
- Click on **Create Scan Rule**.
[See image.](#scanbutton)
- Under **General**:
- For **Scan Rule Name**, enter a unique name for the rule.
- For **Vulnerability Scanning Type**, select **Workloads & Containers**.
- For **Cloud Type**, select **Amazon Web Services**, **Azure**, or **Google Cloud**.
[See image.](#select-cloudtype)
- Click **Next**.
- Under **Resource Scope**:
- Select the required **Cloud Accounts** from the drop-down menu. The menu displays the list of cloud accounts for which cloud workloads are discovered.
- Select the **Cloud Regions** from the drop-down menu. The menu displays the list of regions in which cloud workloads are discovered.
- **(Optional)** **Workload Tags**: Enter the key-value pair that is associated with the resources. Click **Add More** to include additional tags.
You must enter both the key and value for ZPC to be able to identify and scan the cloud workload for vulnerabilities.
[See image.](#scope)
- Click **Next**.
The **Scope Test Result** window displays the number of cloud workloads that are included for vulnerability scanning.
[See image.](#scopetest)
- Click **Accept and Proceed**.
- Under **Scan Schedule**, the default schedule is set to **Weekly**.
[See image.](#weekly-schedule)
When you switch the schedule to **Daily**, a message appears indicating that daily scans could take more than a day depending on the number of workloads that must be scanned, and recursive scans are initiated only after the previous scan is completed. Click **OK**, then set the time.
[See image.](#dailyscan)
- Click **Next**.
- Review the scan rule. Click the **Edit** icon if you want to make any changes.
[See image.](#review)
- Click **Finish**.
You can view the newly added scan rule on the **Vulnerability Management** page under **Scanning Rules**.
[![Add a scanning rule](/downloads/zpc/container-registries-workloads/vulnerability-scanning/adding-vulnerability-scanning-rule-cloud-workloads/zpc-vm-scanrulebutton.png)
]
[![Select the cloud type ](/downloads/zpc/container-registries-workloads/vulnerability-scanning/adding-vulnerability-scanning-rule-cloud-workloads/zpc-vm-wrkloadcontainers.png)
]
[![Add the resource scope details](/downloads/zpc/vulnerability-integrations/vulnerability-scanning/adding-vulnerability-scanning-rule-cloud-workloads/zpc-scanrule-imagetags.png?1669628171)
]
[![View the scope test result](/downloads/zpc/administration/vulnerability-integrations/vulnerability-scanning/adding-vulnerability-scanning-rule-cloud-workloads/zpc-vm-scopetest-cloudworkload.png)
]
[![Review the vulnerability scanning rule](/downloads/zpc/administration/vulnerability-integrations/vulnerability-scanning/adding-vulnerability-scanning-rule-cloud-workloads/zpc-vs-cw-review.png)
]
[![Default scan schedule is weekly](/downloads/zpc/container-registries-workloads/vulnerability-scanning/adding-vulnerability-scanning-rule-cloud-workloads/zpc-scanschedule-wrkloads.png)
]
[![Information about daily scans](/downloads/zpc/container-registries-workloads/vulnerability-scanning/adding-vulnerability-scanning-rule-cloud-workloads/zpc-scanmessage.png)
]